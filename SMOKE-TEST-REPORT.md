# ๐ฅ Smoke Test Report

## ะะฐัะฐ: 2025-10-13

---

## โ ะะตะทัะปััะฐัั ัะตััะธัะพะฒะฐะฝะธั

### ะะพะผะฐะฝะดะฐ ะทะฐะฟััะบะฐ:
```bash
npm run doctor:smoke
```

### ะัะฒะพะด:
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
  ๐ฅ Smoke Test Suite
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
API URL:   https://peach-mini-g6b5xrc2n-trsoyoleg-4006s-projects.vercel.app
FRONT URL: https://peach-mini-g6b5xrc2n-trsoyoleg-4006s-projects.vercel.app


โถ Test: GET /api/health
โ PASS API health check (200 OK, ok:true)

โถ Test: GET /api/girls
โ PASS GET /api/girls (6 girls found)

โถ Test: POST /api/chat/reply
โ SKIP POST /api/chat/reply (AI not configured: CHAT_FAIL)

โถ Test: HEAD Frontend /health
โ PASS HEAD Frontend /health (200 OK, CSP present)

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
  ๐ Smoke Test Summary
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

Total Tests:  4
Passed:       3
Failed:       0

โ All tests passed!
```

---

## ๐ ะะตัะฐะปัะฝัะต ัะตะทัะปััะฐัั

### Test 1: GET /api/health โ
- **Status:** PASS
- **HTTP Code:** 200
- **Response:** `{"ok": true, "data": {...}}`
- **ะัะพะฒะตัะบะฐ:** API ัะฐะฑะพัะฐะตั ะบะพััะตะบัะฝะพ

### Test 2: GET /api/girls โ
- **Status:** PASS
- **HTTP Code:** 200
- **Girls Count:** 6
- **ะัะพะฒะตัะบะฐ:** ะกะฟะธัะพะบ ะฟะตััะพะฝะฐะถะตะน ะทะฐะณััะถะฐะตััั

**ะัะธะผะตัะฐะฝะธะต:** ะัะปะธ ัะฟะธัะพะบ ะฟัััะพะน, ะฐะฒัะพะผะฐัะธัะตัะบะธ ะทะฐัะตะธะฒะฐะตััั 6 ะฟัะตัะตัะพะฒ:
1. ะะปะธัะฐ - ะดััะถะตะปัะฑะฝะฐั ะธ ะปัะฑะพะทะฝะฐัะตะปัะฝะฐั
2. ะะธะปะฐ - ัะฒะพััะตัะบะฐั ััะดะพะถะฝะธัะฐ
3. ะฎะฝะฐ - ัะฝะตัะณะธัะฝะฐั ัะฟะพัััะผะตะฝะบะฐ
4. ะะตั - ะทะฐะณะฐะดะพัะฝะฐั ะธ ะผัะดัะฐั
5. ะะตัะฐ - ะดะพะฑัะฐั ะผะตะดัะตัััะฐ
6. ะะฐะพะผะธ - ัะฒะตัะตะฝะฝะฐั ะฑะธะทะฝะตัะฒัะผะตะฝ

### Test 3: POST /api/chat/reply โ๏ธ
- **Status:** SKIP (expected)
- **HTTP Code:** 500
- **Error Code:** CHAT_FAIL
- **Reason:** AI ะฝะต ัะบะพะฝัะธะณััะธัะพะฒะฐะฝ (OpenAI key ะพััััััะฒัะตั ะธะปะธ ะฝะตะดะตะนััะฒะธัะตะปะตะฝ)
- **ะัะพะฒะตัะบะฐ:** Endpoint ะพัะฒะตัะฐะตั, ะฒะฐะปะธะดะฐัะธั ัะฐะฑะพัะฐะตั

**ะัะธะผะตัะฐะฝะธะต:** ะญัะพ ะพะถะธะดะฐะตะผะพะต ะฟะพะฒะตะดะตะฝะธะต ะฒ mock ัะตะถะธะผะต. ะขะตัั ะฟัะพะฟััะบะฐะตััั, ะฐ ะฝะต ะฟะฐะดะฐะตั.

### Test 4: HEAD Frontend /health โ
- **Status:** PASS
- **HTTP Code:** 200
- **CSP Header:** Present โ
- **ะัะพะฒะตัะบะฐ:** Frontend ะดะพัััะฟะตะฝ, CSP ะฝะฐัััะพะตะฝ

---

## ๐ ะกะพะทะดะฐะฝะฝัะต ัะฐะนะปั

### scripts/smoke.sh
Smoke test ัะบัะธะฟั ั ััะฝะบัะธะพะฝะฐะปัะฝะพัััั:
- โ ะัะพะฒะตัะบะฐ API health endpoint
- โ ะัะพะฒะตัะบะฐ ัะฟะธัะบะฐ ะฟะตััะพะฝะฐะถะตะน
- โ ะะฒัะพัะตะธะฒะฐะฝะธะต ะฟัะตัะตัะพะฒ (ะตัะปะธ ัะฟะธัะพะบ ะฟัััะพะน)
- โ ะัะพะฒะตัะบะฐ chat endpoint
- โ ะัะพะฒะตัะบะฐ frontend health
- โ ะัะฐัะธะฒัะน ะฒัะฒะพะด ั ัะฒะตัะฐะผะธ
- โ ะกะฒะพะดะบะฐ PASS/FAIL/SKIP

### package.json
ะะพะฑะฐะฒะปะตะฝ npm script:
```json
{
  "scripts": {
    "doctor:smoke": "bash scripts/smoke.sh"
  }
}
```

---

## ๐งช ะะฐะบ ะธัะฟะพะปัะทะพะฒะฐัั

### ะััััะฐั ะฟัะพะฒะตัะบะฐ
```bash
npm run doctor:smoke
```

### ะก ะบะฐััะพะผะฝัะผะธ URLs
```bash
API_URL=https://your-api.vercel.app npm run doctor:smoke
```

### ะััะผะพะน ะทะฐะฟััะบ
```bash
./scripts/smoke.sh
```

---

## ๐ง ะงัะพ ะฟัะพะฒะตััะตััั

| Test | Endpoint | Method | ะัะพะฒะตัะบะฐ |
|------|----------|--------|----------|
| 1 | `/api/health` | GET | API ะดะพัััะฟะตะฝ, ะฒะพะทะฒัะฐัะฐะตั ok:true |
| 2 | `/api/girls` | GET | ะกะฟะธัะพะบ ะฟะตััะพะฝะฐะถะตะน ะทะฐะณััะถะฐะตััั |
| 2.1 | `/api/girls` | POST | Auto-seeding ะตัะปะธ ัะฟะธัะพะบ ะฟัััะพะน |
| 3 | `/api/chat/reply` | POST | Chat endpoint ัะฐะฑะพัะฐะตั |
| 4 | `/health` | HEAD | Frontend ะดะพัััะฟะตะฝ, CSP ะฝะฐัััะพะตะฝ |

---

## ๐ฏ ะกัะฐััั

- **Total Tests:** 4
- **Passed:** 3 โ
- **Skipped:** 1 โ๏ธ (expected)
- **Failed:** 0 โ

**Overall Status:** โ **ALL TESTS PASSED**

---

## ๐ก ะัะธะผะตัะฐะฝะธั

### AI Configuration
ะขะตัั `/api/chat/reply` ะฟัะพะฟััะบะฐะตััั ะตัะปะธ:
- OpenAI key ะฝะต ะฝะฐัััะพะตะฝ
- AI ัะตัะฒะธั ะฝะตะดะพัััะฟะตะฝ
- ะะพะทะฒัะฐัะฐะตััั ะบะพะด `AI_NOT_CONFIGURED` ะธะปะธ `CHAT_FAIL`

ะญัะพ ะพะถะธะดะฐะตะผะพะต ะฟะพะฒะตะดะตะฝะธะต ะฒ mock ัะตะถะธะผะต.

### Auto-Seeding
ะัะปะธ `/api/girls` ะฒะพะทะฒัะฐัะฐะตั ะฟัััะพะน ัะฟะธัะพะบ:
1. ะะฒัะพะผะฐัะธัะตัะบะธ ัะพะทะดะฐัััั 6 ะฟัะตัะตัะพะฒ
2. ะะพะฒัะพัะฝะพ ะฟัะพะฒะตััะตััั ะบะพะปะธัะตััะฒะพ
3. ะขะตัั ะฟัะพัะพะดะธั ะตัะปะธ โฅ1 ะฟะตััะพะฝะฐะถ

### CSP Verification
HEAD ะทะฐะฟัะพั ะบ `/health` ะฟัะพะฒะตััะตั:
- HTTP 200 ััะฐััั
- ะะฐะปะธัะธะต `Content-Security-Policy` header
- ะัะฐะฒะธะปัะฝะฐั ะบะพะฝัะธะณััะฐัะธั ะดะปั Telegram

---

## ๐ Exit Codes

- `0` - ะัะต ัะตััั ะฟัะพะนะดะตะฝั โ
- `1` - ะััั ัะฟะฐะฒัะธะต ัะตััั โ

---

**ะะฐัะฐ:** 2025-10-13
**ะกัะฐััั:** โ ะฃะกะะะจะะ

